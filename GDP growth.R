library(tidyverse)

data <- read_csv("Year,OECD,World,UK
1961,4.32899762,3.80083227,2.67711894
1962,5.63064313,5.32027962,1.10290965
1963,5.34649661,5.19242068,4.874384
1964,6.44494913,6.56874854,5.53365939
1965,5.45296196,5.55509745,2.14217654
1966,5.94662928,5.7189637,1.57310041
1967,4.36762613,4.16460115,2.78647464
1968,6.04796996,5.95152032,5.44108344
1969,5.25464677,5.8315231,1.92409683
1970,2.70149761,3.91743115,6.31790667
1971,3.71320992,4.29037073,3.50471735
1972,5.39906363,5.63038895,4.32166767
1973,6.07406842,6.42353349,6.52384845
1974,0.91932697,1.80578801,-2.484404
1975,0.20464826,0.6003285,-1.4736495
1976,4.86112154,5.29748594,2.91026618
1977,3.810022,4.07660676,2.45775046
1978,4.48612901,4.11367292,4.20426055
1979,3.93283211,4.18829763,3.74901651
1980,1.14821206,1.81112657,-2.0313678
1981,2.02929303,1.92876495,-0.7877438
1982,0.24947097,0.41731833,1.99489131
1983,2.93044019,2.62126398,4.22185628
1984,4.71415968,4.67772564,2.26910518
1985,3.70473469,3.71271327,4.147415
1986,3.09409592,3.44548596,3.15034054
1987,3.51018355,3.74107713,5.39273831
1988,4.58239836,4.6605594,5.73241372
1989,3.85631428,3.74057187,2.57760269
1990,3.03824933,2.87617809,0.73375552
1991,1.31360085,1.44638598,-1.1031217
1992,2.17473741,2.05618592,0.40108208
1993,1.33296769,1.80839524,2.48983099
1994,3.1686781,3.29697504,3.84600917
1995,2.65470823,3.08941469,2.53167001
1996,3.14826702,3.61383283,2.4285429
1997,3.57788208,3.86913296,4.90902574
1998,2.95677645,2.79315408,3.15397338
1999,3.37055223,3.50446449,2.99011144
2000,4.05857896,4.50127812,3.67236911
2001,1.39040852,2.00011097,2.07265628
2002,1.59328481,2.33728103,2.12322277
2003,2.11415491,3.15953056,3.02988993
2004,3.27848081,4.48006973,2.35562976
2005,2.88156235,4.04836095,2.59328001
2006,3.10305939,4.49572318,2.58410468
2007,2.67892092,4.43886395,2.26948687
2008,0.29330462,2.00094978,-0.2396381
2009,-3.3283524,-1.3070194,-4.2473563
2010,2.91887669,4.49485996,2.1314382
2011,1.894266,3.33973074,1.45756339
2012,1.3709082,2.67305974,1.46988752
2013,1.53170082,2.84485442,1.89001834
2014,2.16804228,3.11786321,2.99116481
2015,2.59131582,3.16837298,2.62259668
2016,1.85169793,2.82511803,2.26346354
2017,2.5089281,3.39442343,2.13445309
2018,2.37300971,3.2696727,1.6509255
2019,1.74139063,2.60087777,1.6719442
2020,-4.4691426,-3.2934966,-9.39616")

data %>%
  pivot_longer(!Year, names_to = "variable", values_to = 'GDP Growth') %>%
  mutate(variable = factor(variable, levels = c('World','OECD','UK'))) %>%
  ggplot(aes(x = Year, y = `GDP Growth`)) + labs(title = '') +
  facet_grid(rows = vars(variable)) + xlab(NULL) + ylab(NULL) +
  geom_line() + MyThemes::theme_base() + scale_colour_viridis_d() +
  theme(legend.position = 'none') -> f1


data %>%
  mutate(decade = paste0(substr(Year,1,3),'0s')) %>%
  select(2:5) %>%
  group_by(decade) %>%
  summarise(across(everything(), ~mean(.x, na.rm = T))) %>%
  filter(decade != '2020s') %>%
  pivot_longer(!decade, names_to = "variable", values_to = 'GDP Growth') %>%
  mutate(variable = factor(variable, levels = c('World','OECD','UK'))) %>%
  ggplot(aes(x = decade, y = `GDP Growth`)) + labs(title = 'The decline in GDP growth (World Bank data)') +
  facet_grid(rows = vars(variable)) + xlab(NULL) + ylab(NULL) +
  geom_col() + MyThemes::theme_base() + scale_colour_viridis_d() +
  theme(legend.position = 'none',
        strip.background = element_blank(),
        strip.text.y = element_blank()) -> f2

gridExtra::grid.arrange(f2,f1, nrow = 1, ncol = 2)
